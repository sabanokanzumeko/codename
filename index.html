<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Codename Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-b from-white to-slate-50">
  <div id="root"></div>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState } = React;

    // --- 名前リスト ----------------------------------------------------------
    const codenameList = [
      "ぶり大根",
      "竜泉寺　おゆこ",
      "ナポリげた男",
      "環状線　充",
      "ジャガーバタコ",
      "金銀堂　星男",
      "ちょーみーキティ子",
      "辛い　茄子",
      "チェーリーテンプル",
      "下駄子",
      "鈴木太郎",
      "ダンシング美智子",
      "ゴンザレス長谷川",
      "痣とイチボ",
      "厚着厚子",
      "勝どき橋　渡子",
      "ジャンボタニシ",
      "薬師寺　煎子",
      "棚からぼたこ",
      "ドリーミング吾郎",
      "立川太刀枝",
      "八王子光雄",
      "さんざめく石子",
      "大魔王はなこ",
      "磯部丸",
      "松竹　梅男",
      "サルシッチャ渚",
    ];

    // 32-bit FNV-1a（英数字・日本語もOK）
    function hashString(str) {
      let h = 0x811c9dc5;
      for (let i = 0; i < str.length; i++) {
        h ^= str.charCodeAt(i);
        h = (h + (h << 1) + (h << 4) + (h << 7) + (h << 8) + (h << 24)) >>> 0;
      }
      return h >>> 0;
    }

    function App() {
      const [name, setName] = useState("");
      const [result, setResult] = useState(null); // 初回生成まで非表示

      function generateCodename() {
        if (result) return; // ボタン連打しても同じ（何もしない）
        const baseSeed = hashString((name || "anonymous").trim());
        const idx = baseSeed % codenameList.length;
        setResult(codenameList[idx]);
      }

      return (
        <div className="min-h-screen w-full flex items-center justify-center p-6">
          <div className="w-full max-w-3xl">
            <div className="mb-6 text-center">
              <h1 className="text-3xl sm:text-4xl font-bold tracking-tight">あなたにおもしろネームをつけます😍</h1>
              <p className="text-slate-600 mt-2">入力した名前からあなたにぴったりの名前が設定されます</p>
            </div>

            <div className="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-4">
              <input
                className="sm:col-span-2 rounded-2xl border border-slate-200 bg-white px-4 py-3 shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-400"
                placeholder="名前を入力してください"
                value={name}
                onChange={(e) => { setName(e.target.value); setResult(null); }}
              />
              <button
                className="rounded-2xl border border-slate-200 bg-black text-white px-4 py-3 shadow-sm hover:opacity-90 active:opacity-80"
                onClick={generateCodename}
              >おもしろネームを作る</button>
            </div>

            {result && (
              <div className="grid gap-3">
                <div className="flex flex-col gap-2 rounded-2xl border border-slate-200 bg-white px-4 py-4 shadow-sm">
                  <div className="text-lg font-semibold tracking-tight">{result}</div>
                  <div className="flex gap-3 mt-2">
                    <a
                      href={`https://twitter.com/intent/tweet?text=私のおもしろネームは「${encodeURIComponent(result)}」です！みんなのおもしろネームも教えてね✌️https://codename-wtjb.vercel.app/`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="rounded-xl border border-slate-200 bg-black text-white px-3 py-2 hover:opacity-90"
                    >Xでシェア</a>
                    <a
                      href={`https://line.me/R/msg/text/?私のおもしろネームは「${encodeURIComponent(result)}」です！みんなのおもしろネームも教えてね✌️https://codename-wtjb.vercel.app/`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="rounded-xl border border-slate-200 bg-green-500 text-white px-3 py-2 hover:opacity-90"
                    >LINEでシェア</a>
                  </div>
                </div>
              </div>
            )}

            <div className="mt-8 text-xs text-slate-500 text-center">deterministic by name • client-only • no tracking • made with 鯖の味噌煮</div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
